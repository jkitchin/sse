
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>gitHUB Actions &#8212; Scientific software engineering</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "jkitchin/s24-06643");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ğŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Wrapping up" href="../09-wrapup/09-wrapup.html" />
    <link rel="prev" title="Introduction to GitHUB" href="../07-github-intro/07-github-intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/cmu-sse.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Scientific software engineering</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Scientific Software Engineering
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../00-introduction/00-introduction-terminals.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01-rest-api-openalex/01-rest-api-openalex.html">
   OpenAlex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02-python-requests/02-python-requests.html">
   Python and REST APIs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03-python-packaging/03-python-packaging.html">
   Python packaging and version control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04-more-python-packaging/04-more-python-packaging.html">
   More on Python packaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05-python-classes/05-python-classes.html">
   Introduction Python Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06-code-quality/06-code-quality.html">
   Code quality control
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-github-intro/07-github-intro.html">
   Introduction to GitHUB
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   gitHUB Actions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09-wrapup/09-wrapup.html">
   Wrapping up
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11-advanced-packaging/advanced-packaging.html">
   Advanced packaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../genindex.html">
   Index
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  About the book
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../build-statistics.html">
   Build statistics
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/08-github-actions/08-github-actions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jkitchin/s24-06643"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/jkitchin/s24-06643/issues/new?title=Issue%20on%20page%20%2F08-github-actions/08-github-actions.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/jkitchin/s24-06643/main?urlpath=lab/tree/sse/08-github-actions/08-github-actions.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://jupyterhub-dev.cheme.cmu.edu/hub/user-redirect/git-pull?repo=https://github.com/jkitchin/s24-06643&urlpath=lab/tree/s24-06643/sse/08-github-actions/08-github-actions.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="../_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/jkitchin/s24-06643/blob/main/sse/08-github-actions/08-github-actions.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   gitHUB Actions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-setup">
   Lecture setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#brief-exploration-of-the-repo">
   Brief exploration of the repo
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-github-do-the-work-instead-of-your-computer">
   Making GitHUB do the work instead of your computer
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   GitHUB Actions ()
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-status-badge">
     Create a status badge
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-platform-testing">
   Cross platform testing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing-on-windows">
     Testing on Windows.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing-for-macs">
     Testing for Macs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#custom-environments-with-docker">
   Custom environments with Docker
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-up">
   Cleaning up
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>gitHUB Actions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   gitHUB Actions
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lecture-setup">
   Lecture setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#brief-exploration-of-the-repo">
   Brief exploration of the repo
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-github-do-the-work-instead-of-your-computer">
   Making GitHUB do the work instead of your computer
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   GitHUB Actions ()
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-status-badge">
     Create a status badge
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cross-platform-testing">
   Cross platform testing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing-on-windows">
     Testing on Windows.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing-for-macs">
     Testing for Macs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#custom-environments-with-docker">
   Custom environments with Docker
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cleaning-up">
   Cleaning up
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="github-actions">
<h1>gitHUB Actions<a class="headerlink" href="#github-actions" title="Permalink to this headline">Â¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start clean</span>
<span class="o">!</span><span class="w"> </span>rm<span class="w"> </span>-fr<span class="w"> </span>s24-06643-L08
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="lecture-setup">
<h1>Lecture setup<a class="headerlink" href="#lecture-setup" title="Permalink to this headline">Â¶</a></h1>
<ol class="simple">
<li><p>Make sure you are logged into GitHUB.</p></li>
<li><p>Go to <a class="reference external" href="https://github.com/Steel-Bank-codespaces/s24-06643-L08"></a>.</p></li>
</ol>
<p>Look for the fork button.</p>
<p>then click it. This will â€œforkâ€ the repo, i.e. make a copy of it in your GitHUB account.</p>
<p>Then, come back here and open a terminal. Navigate to the lecture directory and run</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>! git clone https://github.com/&lt;github-id&gt;/s24-06643-L08.git
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>rm<span class="w"> </span>-fr<span class="w"> </span>s24-06643-L08
<span class="o">!</span><span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:jkitchin/s24-06643-L08.git
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning into &#39;s24-06643-L08&#39;...
remote: Enumerating objects: 12, done.
remote: Counting objects: 100% (12/12), done.
remote: Compressing objects: 100% (10/10), done.
remote: Total 12 (delta 0), reused 11 (delta 0), pack-reused 0
Receiving objects: 100% (12/12), 15.99 KiB | 15.99 MiB/s, done.
</pre></div>
</div>
</div>
</div>
<p>to make your own copy locally we can work on.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="brief-exploration-of-the-repo">
<h1>Brief exploration of the repo<a class="headerlink" href="#brief-exploration-of-the-repo" title="Permalink to this headline">Â¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>tree<span class="w"> </span>s24-06643-L08
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">s24-06643-L08</span>
â”œâ”€â”€ example.ipynb
â”œâ”€â”€ LICENSE
â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">pkg</span>
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">s23oa</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.py
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ test_ris.py
â”‚Â Â  â”‚Â Â  â””â”€â”€ works.py
â”‚Â Â  â””â”€â”€ setup.py
â””â”€â”€ README.md

2 directories, 7 files
</pre></div>
</div>
</div>
</div>
<p>It is a good idea to check if the test pass. They donâ€™t, so you have something to fix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
pytest
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================= test session starts ==============================
platform linux -- Python 3.9.7, pytest-7.2.2, pluggy-1.3.0
rootdir: /home/jupyter-jkitchin@andrew.cm-11dd7/s24-06643/sse/08-github-actions/s24-06643-L08
plugins: typeguard-2.13.3, anyio-3.6.1
collected 1 item

pkg/s23oa/test_ris.py .                                                  [100%]

============================== 1 passed in 1.11s ===============================
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08/pkg
pip install .
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Defaulting to user installation because normal site-packages is not writeable
Processing /home/jupyter-jkitchin@andrew.cm-11dd7/s24-06643/sse/08-github-actions/s24-06643-L08/pkg
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status &#39;done&#39;
Building wheels for collected packages: s23oa
  Building wheel for s23oa (setup.py): started
  Building wheel for s23oa (setup.py): finished with status &#39;done&#39;
  Created wheel for s23oa: filename=s23oa-0.0.1-py3-none-any.whl size=2954 sha256=0b9a6f967968240f6bfa5bb4ef60f57516005f2984d7cb7e7b8e6f9a1682597e
  Stored in directory: /tmp/pip-ephem-wheel-cache-9ggnj7fw/wheels/a5/ef/4f/a3414c9d9813b9d7fb83b2151f8f05d3b71fe50e5ca5330dfa
Successfully built s23oa
Installing collected packages: s23oa
  Attempting uninstall: s23oa
    Found existing installation: s23oa 0.0.1
    Uninstalling s23oa-0.0.1:
      Successfully uninstalled s23oa-0.0.1
Successfully installed s23oa-0.0.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> s24-06643-L08/example.ipynb
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre>TY  - JOUR
AU  - John R. Kitchin
PY  - 2015
TI  - Examples of Effective Data Sharing in Scientific Publishing
JO  - ACS Catalysis
VL  - 5
IS  - 6
SP  - 3894
EP  - 3899
DO  - https://doi.org/10.1021/acscatal.5b00538
ER  -</pre><br><a href="data:text/plain;base64,VFkgIC0gSk9VUgpBVSAgLSBKb2huIFIuIEtpdGNoaW4KUFkgIC0gMjAxNQpUSSAgLSBFeGFtcGxlcyBvZiBFZmZlY3RpdmUgRGF0YSBTaGFyaW5nIGluIFNjaWVudGlmaWMgUHVibGlzaGluZwpKTyAgLSBBQ1MgQ2F0YWx5c2lzClZMICAtIDUKSVMgIC0gNgpTUCAgLSAzODk0CkVQICAtIDM4OTkKRE8gIC0gaHR0cHM6Ly9kb2kub3JnLzEwLjEwMjEvYWNzY2F0YWwuNWIwMDUzOApFUiAgLQ==" download="ris">Download RIS</a></div></div>
</div>
<p>Looks good for now.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="making-github-do-the-work-instead-of-your-computer">
<h1>Making GitHUB do the work instead of your computer<a class="headerlink" href="#making-github-do-the-work-instead-of-your-computer" title="Permalink to this headline">Â¶</a></h1>
<p>We have learned about pre-commit hooks, where you leverage git to run tests, do formatting, check styles, etc. These are ideal for your side of the work, that is, we check before submitting to GitHUB.</p>
<p>There is also a way to do checks <em>after</em> you submit to GitHUB. This is a specific feature of GitHUB, but you may find similar features in other services like bitbucket or gitlab.</p>
<p>A workflow is a setup for an environment to run some commands in, and a set of commands to be run. Before we get into the details of those two things, we will talk about YAML (<a class="reference external" href="https://yaml.org/">https://yaml.org/</a>), which is recursively defined as â€œYAML ainâ€™t markup languageâ€. It is a data serialization language often used for configurations. It is specifically a data language, and is not meant to be used to write documents (in contrast to Markdown, for example).</p>
<p>You can learn YAML here <a class="reference external" href="https://learnxinyminutes.com/docs/yaml/">https://learnxinyminutes.com/docs/yaml/</a>. We will learn by example today.</p>
<p>Yaml is comprised of key:value pairs (like a dictionary) and lists.  These can be opened/closed by changing indentation levels.</p>
<p>To get a sense for how to read YAML, we will use pyyaml to read some.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yaml</span>

<span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;name: my action&#39;</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;name&#39;: &#39;my action&#39;}
</pre></div>
</div>
</div>
</div>
<p>A two line string loads like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">name: grading</span>
<span class="s1">runs-on: ubuntu-latest</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;name&#39;: &#39;grading&#39;, &#39;runs-on&#39;: &#39;ubuntu-latest&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">steps:</span>
<span class="s1">  - uses: actions/checkout@v3</span>
<span class="s1">    with:</span>
<span class="s1">      fetch-depth: 0</span>
<span class="s1">  - uses: education/autograding@v1</span>
<span class="s1">    name: &quot;Grading and Feedback&quot;</span>
<span class="s1">&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">SafeLoader</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;steps&#39;: [{&#39;uses&#39;: &#39;actions/checkout@v3&#39;, &#39;with&#39;: {&#39;fetch-depth&#39;: 0}},
  {&#39;uses&#39;: &#39;education/autograding@v1&#39;, &#39;name&#39;: &#39;Grading and Feedback&#39;}]}
</pre></div>
</div>
</div>
</div>
<p>These files usually get put into a file with an extension of .yml or .yaml. We have to create YAML files to tell GitHUB what to do for actions and workflows.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1>GitHUB Actions (<a class="reference external" href="https://docs.github.com/en/actions"></a>)<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h1>
<p>To make a new workflow, you create a .yml or .yaml file in <code class="docutils literal notranslate"><span class="pre">.github/workflows</span></code>.</p>
<p>GitHUB actions are sophisticated, and cover a lot of ground: <a class="reference external" href="https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#about-yaml-syntax-for-workflows">https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#about-yaml-syntax-for-workflows</a>.</p>
<p>There are a few things every workflow must have in it. One is a name, and one is what triggers it to run. Here we specify those things. Put this in a file called <code class="docutils literal notranslate"><span class="pre">.github/workflows/my-workflow.yaml</span></code>. This will give your action a name, and it will get run when ever anything is pushed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
mkdir -p s24-06643-L08/.github/workflows
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/.github/workflows/my-workflow.yaml
<span class="n">name</span><span class="p">:</span> <span class="n">First</span> <span class="n">job</span>
<span class="n">on</span><span class="p">:</span> <span class="n">push</span>

<span class="n">jobs</span><span class="p">:</span>
  <span class="n">my_first_job</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pwd</span> 
          <span class="n">ls</span> <span class="o">-</span><span class="n">alF</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing s24-06643-L08/.github/workflows/my-workflow.yaml
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git add .github
git commit .github -m &quot;add new workflow&quot;
git push
git status
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main 8b96328] add new workflow
 1 file changed, 10 insertions(+)
 create mode 100644 .github/workflows/my-workflow.yaml
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   7d183d3..8b96328  main -&gt; main
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>On branch main
Your branch is up to date with &#39;origin/main&#39;.

Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working directory)
	modified:   example.ipynb
	modified:   pkg/s23oa/works.py

Untracked files:
  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)
	.ipynb_checkpoints/
	pkg/s23oa/.ipynb_checkpoints/

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)
</pre></div>
</div>
</div>
</div>
<p>Go ahead and commit this new file. Before you push it, remember to go to <a class="reference external" href="https://github.com/settings/tokens"></a> to setup a personal access token. Make sure to select the repo and workflow items this time.</p>
<p>Also, go ahead and run this command in the repo in the terminal before you push:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git config credential.helper store
</pre></div>
</div>
<p>then, go ahead and push it back to your forked version.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>you may see something like</p>
<p>jupyter-jkitchin&#64;andrew.cm-11dd7&#64;jupyterhub-dev:~/src/lectures/08-github-actions/s23-06682-L08$ git push
remote: Invalid username or password.
fatal: Authentication failed for â€˜<a class="reference external" href="https://github.com/jkitchin/s23-06682-L08.git/">https://github.com/jkitchin/s23-06682-L08.git/</a>â€™</p>
<p>because there may be a saved value from last class. Try it again and see if it prompts you for a username, and then paste your new token in.</p>
</div>
<p>Assuming that worked, now we can go check out what happened. Navigate back to your repo. You can find it like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git remote -v
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>origin	git@github.com:jkitchin/s24-06643-L08.git (fetch)
origin	git@github.com:jkitchin/s24-06643-L08.git (push)
</pre></div>
</div>
</div>
</div>
<p>There are a bunch of new things. You can see where the repo was forked from, and that it is one commit ahead of the repo it was forked from.</p>
<p>Next, navigate to the Actions tab. Letâ€™s see what happened.</p>
<p>There isnâ€™t much in the actions output. In fact, there is nothing at all! When the virtual machine that runs this spins up, it is bare and has almost nothing in it. It does not even have your repo in it.</p>
<p>Letâ€™s add a second job and learn a new trick about using â€œactionsâ€. Here we checkout a copy of our repo, then we update apt so we can install tree. What is with the â€œsudoâ€? You need <code class="docutils literal notranslate"><span class="pre">root</span></code> or <code class="docutils literal notranslate"><span class="pre">superuser</span></code> privileges to install packages, and we get that with <code class="docutils literal notranslate"><span class="pre">sudo</span></code>. It is short for â€œsuperuser doâ€.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/.github/workflows/my-workflow.yaml
<span class="n">name</span><span class="p">:</span> <span class="n">First</span> <span class="n">job</span>
<span class="n">on</span><span class="p">:</span> <span class="n">push</span>

<span class="n">jobs</span><span class="p">:</span>
  <span class="n">my_first_job</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pwd</span> 
          <span class="n">ls</span> <span class="o">-</span><span class="n">alF</span>

  <span class="n">my_second_job</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>      
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="nd">@v3</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span> 
          <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">tree</span> 
          <span class="n">tree</span> <span class="o">-</span><span class="n">F</span> <span class="o">.</span>            
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting s24-06643-L08/.github/workflows/my-workflow.yaml
</pre></div>
</div>
</div>
</div>
<p>Now we need to commit and push this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>tree<span class="w"> </span>-a<span class="w"> </span>s24-06643-L08
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold -Color-Bold-Blue">s24-06643-L08</span>
â”œâ”€â”€ example.ipynb
â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">.git</span>
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">branches</span>
â”‚Â Â  â”œâ”€â”€ config
â”‚Â Â  â”œâ”€â”€ description
â”‚Â Â  â”œâ”€â”€ HEAD
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">hooks</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">applypatch-msg.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">commit-msg.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">fsmonitor-watchman.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">post-update.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">pre-applypatch.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">pre-commit.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">pre-merge-commit.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">prepare-commit-msg.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">pre-push.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">pre-rebase.sample</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">pre-receive.sample</span>
â”‚Â Â  â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Green">update.sample</span>
â”‚Â Â  â”œâ”€â”€ index
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">info</span>
â”‚Â Â  â”‚Â Â  â””â”€â”€ exclude
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">logs</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ HEAD
â”‚Â Â  â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">refs</span>
â”‚Â Â  â”‚Â Â      â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">heads</span>
â”‚Â Â  â”‚Â Â      â”‚Â Â  â””â”€â”€ main
â”‚Â Â  â”‚Â Â      â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">remotes</span>
â”‚Â Â  â”‚Â Â          â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">origin</span>
â”‚Â Â  â”‚Â Â              â””â”€â”€ HEAD
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">objects</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">info</span>
â”‚Â Â  â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">pack</span>
â”‚Â Â  â”‚Â Â      â”œâ”€â”€ pack-8616fb194ad9fff36118ee2d96578d6fedb2cf31.idx
â”‚Â Â  â”‚Â Â      â””â”€â”€ pack-8616fb194ad9fff36118ee2d96578d6fedb2cf31.pack
â”‚Â Â  â”œâ”€â”€ packed-refs
â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">refs</span>
â”‚Â Â      â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">heads</span>
â”‚Â Â      â”‚Â Â  â””â”€â”€ main
â”‚Â Â      â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">remotes</span>
â”‚Â Â      â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">origin</span>
â”‚Â Â      â”‚Â Â      â””â”€â”€ HEAD
â”‚Â Â      â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">tags</span>
â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">.github</span>
â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">workflows</span>
â”‚Â Â      â””â”€â”€ my-workflow.yaml
â”œâ”€â”€ .gitignore
â”œâ”€â”€ LICENSE
â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">pkg</span>
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">build</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">bdist.linux-x86_64</span>
â”‚Â Â  â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">lib</span>
â”‚Â Â  â”‚Â Â      â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">s23oa</span>
â”‚Â Â  â”‚Â Â          â”œâ”€â”€ __init__.py
â”‚Â Â  â”‚Â Â          â”œâ”€â”€ test_ris.py
â”‚Â Â  â”‚Â Â          â””â”€â”€ works.py
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">s23oa</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.py
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">.ipynb_checkpoints</span>
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ works-checkpoint.py
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">__pycache__</span>
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ __init__.cpython-39.pyc
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ test_ris.cpython-39-pytest-7.2.2.pyc
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ works.cpython-39.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ test_ris.py
â”‚Â Â  â”‚Â Â  â””â”€â”€ works.py
â”‚Â Â  â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">s23oa.egg-info</span>
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ dependency_links.txt
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ PKG-INFO
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ SOURCES.txt
â”‚Â Â  â”‚Â Â  â””â”€â”€ top_level.txt
â”‚Â Â  â””â”€â”€ setup.py
â”œâ”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">.pytest_cache</span>
â”‚Â Â  â”œâ”€â”€ CACHEDIR.TAG
â”‚Â Â  â”œâ”€â”€ .gitignore
â”‚Â Â  â”œâ”€â”€ README.md
â”‚Â Â  â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">v</span>
â”‚Â Â      â””â”€â”€ <span class=" -Color -Color-Bold -Color-Bold-Blue">cache</span>
â”‚Â Â          â”œâ”€â”€ lastfailed
â”‚Â Â          â”œâ”€â”€ nodeids
â”‚Â Â          â””â”€â”€ stepwise
â””â”€â”€ README.md

31 directories, 51 files
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git add .github/workflows/my-workflow.yaml
git commit .github/workflows/my-workflow.yaml -m &quot;add second job&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main c17b247] add second job
 1 file changed, 9 insertions(+)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   8b96328..c17b247  main -&gt; main
</pre></div>
</div>
</div>
</div>
<p>It may take a while, but soon a new Action task should launch.</p>
<p>Finally, you see we have a copy of our current repository. This still isnâ€™t that exciting, after all, we already knew we had those! We are leading up to setting up some tests.</p>
<p>It is a little challenging to know what all is installed remotely. Letâ€™s add a third job, this time we install <code class="docutils literal notranslate"><span class="pre">black</span></code> and run it on our repository. We only run in check mode, so if this fails, then this job will fail.</p>
<p>We donâ€™t need the first or second job any more, so letâ€™s delete that.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
black --check .
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>would reformat .ipynb_checkpoints/example-checkpoint.ipynb
would reformat pkg/s23oa/test_ris.py
would reformat pkg/s23oa/__init__.py
would reformat pkg/s23oa/.ipynb_checkpoints/test_ris-checkpoint.py
would reformat example.ipynb
would reformat pkg/setup.py
would reformat pkg/s23oa/.ipynb_checkpoints/works-checkpoint.py
would reformat pkg/s23oa/works.py

Oh no! ğŸ’¥ ğŸ’” ğŸ’¥
8 files would be reformatted.
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">CalledProcessError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="nn">Input In [24],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_cell_magic</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;cd s24-06643-L08</span><span class="se">\n</span><span class="s1">black --check .</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nn">File /opt/tljh/user/lib/python3.9/site-packages/IPython/core/interactiveshell.py:2358,</span> in <span class="ni">InteractiveShell.run_cell_magic</span><span class="nt">(self, magic_name, line, cell)</span>
<span class="g g-Whitespace">   </span><span class="mi">2356</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2357</span>     <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">magic_arg_s</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2358</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2359</span> <span class="k">return</span> <span class="n">result</span>

<span class="nn">File /opt/tljh/user/lib/python3.9/site-packages/IPython/core/magics/script.py:153,</span> in <span class="ni">ScriptMagics._make_script_magic.&lt;locals&gt;.named_script_magic</span><span class="nt">(line, cell)</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span>     <span class="n">line</span> <span class="o">=</span> <span class="n">script</span>
<span class="ne">--&gt; </span><span class="mi">153</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shebang</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

<span class="nn">File /opt/tljh/user/lib/python3.9/site-packages/IPython/core/magics/script.py:305,</span> in <span class="ni">ScriptMagics.shebang</span><span class="nt">(self, line, cell)</span>
<span class="g g-Whitespace">    </span><span class="mi">300</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">raise_error</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">301</span>     <span class="c1"># If we get here and p.returncode is still None, we must have</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span>     <span class="c1"># killed it but not yet seen its return code. We don&#39;t wait for it,</span>
<span class="g g-Whitespace">    </span><span class="mi">303</span>     <span class="c1"># in case it&#39;s stuck in uninterruptible sleep. -9 = SIGKILL</span>
<span class="g g-Whitespace">    </span><span class="mi">304</span>     <span class="n">rc</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">9</span>
<span class="ne">--&gt; </span><span class="mi">305</span>     <span class="k">raise</span> <span class="n">CalledProcessError</span><span class="p">(</span><span class="n">rc</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

<span class="ne">CalledProcessError</span>: Command &#39;b&#39;cd s24-06643-L08\nblack --check .\n&#39;&#39; returned non-zero exit status 1.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/.github/workflows/my-workflow.yaml
<span class="n">name</span><span class="p">:</span> <span class="n">First</span> <span class="n">job</span>
<span class="n">on</span><span class="p">:</span> <span class="n">push</span>

<span class="n">jobs</span><span class="p">:</span>

  <span class="n">my_third_job</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>      
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="nd">@v3</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pip</span> <span class="n">install</span> <span class="n">black</span>
          <span class="n">black</span> <span class="o">--</span><span class="n">check</span> <span class="o">.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting s24-06643-L08/.github/workflows/my-workflow.yaml
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git commit .github/workflows/my-workflow.yaml -m &quot;add third job&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main 00c8340] add third job
 1 file changed, 4 insertions(+), 10 deletions(-)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   c17b247..00c8340  main -&gt; main
</pre></div>
</div>
</div>
</div>
<p>Now go back to your Actions tab. You will see that the third job should have failed. We can fix it by running black locally. Check your email, you should have gotten a notification that a job failed!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
black .
git commit -am &quot;ran black&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>reformatted .ipynb_checkpoints/example-checkpoint.ipynb
reformatted pkg/s23oa/.ipynb_checkpoints/test_ris-checkpoint.py
reformatted example.ipynb
reformatted pkg/s23oa/__init__.py
reformatted pkg/s23oa/test_ris.py
reformatted pkg/setup.py
reformatted pkg/s23oa/.ipynb_checkpoints/works-checkpoint.py
reformatted pkg/s23oa/works.py

All done! âœ¨ ğŸ° âœ¨
8 files reformatted.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main 6eab6cf] ran black
 5 files changed, 165 insertions(+), 151 deletions(-)
 rewrite example.ipynb (86%)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   00c8340..6eab6cf  main -&gt; main
</pre></div>
</div>
</div>
</div>
<div class="section" id="create-a-status-badge">
<h2>Create a status badge<a class="headerlink" href="#create-a-status-badge" title="Permalink to this headline">Â¶</a></h2>
<p>In the actions view there is a place to create a status badge. This is some Markdown that GitHUB can render. Copy this to your <a class="reference external" href="http://Readme.md">Readme.md</a> file, then commit and push it. This text is simply an svg image url that gets updated when the Actions are run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git pull
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>From github.com:jkitchin/s24-06643-L08
   6eab6cf..d4160c7  main       -&gt; origin/main
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Updating 6eab6cf..d4160c7
Fast-forward
 README.md    | 5 ++++-
 pkg/setup.py | 2 +-
 2 files changed, 5 insertions(+), 2 deletions(-)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git commit README.md -m &quot;add badge&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>On branch main
Your branch is up to date with &#39;origin/main&#39;.

Untracked files:
  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)
	pkg/s23oa/.ipynb_checkpoints/

nothing added to commit but untracked files present (use &quot;git add&quot; to track)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Everything up-to-date
</pre></div>
</div>
</div>
</div>
<p>Now on gitHUB, you should be able to see the badge.</p>
<p>Letâ€™s add one new task to run our tests. This one requires us to install all the libraries needed for our test to work. Note that with the checkout action we start in our repo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/.github/workflows/my-workflow.yaml
<span class="n">name</span><span class="p">:</span> <span class="n">tests</span>
<span class="n">on</span><span class="p">:</span> <span class="n">push</span>

<span class="n">jobs</span><span class="p">:</span>

  <span class="n">black</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>      
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="nd">@v4</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pip</span> <span class="n">install</span> <span class="n">black</span>
          <span class="n">black</span> <span class="o">--</span><span class="n">check</span> <span class="o">.</span>
        
  <span class="n">pytest</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>      
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="nd">@v4</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pip</span> <span class="n">install</span> <span class="n">matplotlib</span> <span class="n">requests</span> <span class="n">IPython</span> <span class="n">pytest</span>
          <span class="n">pytest</span> <span class="o">.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overwriting s24-06643-L08/.github/workflows/my-workflow.yaml
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git commit -am &quot;update to v4&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main 3b6e8fd] update to v4
 1 file changed, 2 insertions(+), 2 deletions(-)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   6ab6c8a..3b6e8fd  main -&gt; main
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="cross-platform-testing">
<h1>Cross platform testing<a class="headerlink" href="#cross-platform-testing" title="Permalink to this headline">Â¶</a></h1>
<p>These tests are more expensive than the Linux tests, so do not use them alot if you donâ€™t need them.</p>
<div class="section" id="testing-on-windows">
<h2>Testing on Windows.<a class="headerlink" href="#testing-on-windows" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/.github/workflows/windows-workflow.yaml
<span class="n">name</span><span class="p">:</span> <span class="n">Windows</span> <span class="n">testing</span>
<span class="n">on</span><span class="p">:</span> <span class="n">push</span>

<span class="n">jobs</span><span class="p">:</span>
  <span class="n">windows</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">windows</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">systeminfo</span>
        
  <span class="n">pytest</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">windows</span><span class="o">-</span><span class="n">lattest</span>
    <span class="n">steps</span><span class="p">:</span>      
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="nd">@v3</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pip</span> <span class="n">install</span> <span class="n">matplotlib</span> <span class="n">requests</span> <span class="n">IPython</span> <span class="n">pytest</span>
          <span class="n">pytest</span> <span class="o">.</span>        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing s24-06643-L08/.github/workflows/windows-workflow.yaml
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git add .github/workflows/windows-workflow.yaml
git commit -m &quot;add Windows test&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main ddaddb6] add Windows test
 1 file changed, 17 insertions(+)
 create mode 100644 .github/workflows/windows-workflow.yaml
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   3b6e8fd..ddaddb6  main -&gt; main
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="testing-for-macs">
<h2>Testing for Macs<a class="headerlink" href="#testing-for-macs" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/.github/workflows/mac-workflow.yaml
<span class="n">name</span><span class="p">:</span> <span class="n">MacOS</span> <span class="n">testing</span>
<span class="n">on</span><span class="p">:</span> <span class="n">push</span>

<span class="n">jobs</span><span class="p">:</span>
  <span class="n">mac</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">macos</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pwd</span> 
          <span class="n">ls</span> <span class="o">-</span><span class="n">alF</span>
          <span class="n">sw_vers</span>
        
  <span class="n">pytest</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">macos</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>      
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="nd">@v3</span>
      <span class="o">-</span> <span class="n">run</span><span class="p">:</span> <span class="o">|</span>
          <span class="n">pip</span> <span class="n">install</span> <span class="n">matplotlib</span> <span class="n">requests</span> <span class="n">IPython</span> <span class="n">pytest</span>
          <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pytest</span>       
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing s24-06643-L08/.github/workflows/mac-workflow.yaml
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git add .github/workflows/mac-workflow.yaml
git commit -m &quot;add Mac test&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main 08df131] add Mac test
 1 file changed, 19 insertions(+)
 create mode 100644 .github/workflows/mac-workflow.yaml
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   ddaddb6..08df131  main -&gt; main
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="custom-environments-with-docker">
<h1>Custom environments with Docker<a class="headerlink" href="#custom-environments-with-docker" title="Permalink to this headline">Â¶</a></h1>
<p>It can be tedious, and time-consuming to have to install everything in your GitHUB actions environment. The tedious part is not too avoidable, that work has to be done somewhere, at least once. The time-consuming part can be problematic though; 1) you have to wait for it each time, 2) for open-source projects the time is â€œfreeâ€ but may be capped at 2000 minutes a month (or whatever GitHUB decides it wants). Furthermore, a single workflow can only run up to 58 minutes. There are three strategies to mitigate these: 1) Pay for more time, 2) setup an external server to run your actions, and 3) streamline the actions by using Docker images that are pre-built. We only consider the last of these today, and we only partially consider how to use Docker.</p>
<p>This example is adapted from <a class="reference external" href="https://docs.github.com/es/actions/creating-actions/creating-a-docker-container-action"></a>.</p>
<p>This is an advanced example. It may be the longest version of â€œHello Worldâ€ I have seen yet. There is quite a bit of setup here. The idea is we run a virtual machine inside the virtual machine. Here we use a Dockerfile inside our repo, but you can also use images from Dockerhub, for example.</p>
<p>Our goal is to run a simple shell script inside a Docker image that is inside GitHUB actions. This allows us to customize the environment, e.g. we could install python, or LaTeX, or any other things we want. We donâ€™t do those things here, and instead focus on the smallest working example we can get get.</p>
<p>First, we define a shell script called <a class="reference external" href="http://entrypoint.sh">entrypoint.sh</a>. It will take one argument, and echo â€œHello argumentâ€. We will also run our tests in this script. Make this script executable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/entrypoint.sh
<span class="ch">#!/bin/sh -l</span>

<span class="n">echo</span> <span class="s2">&quot;Hello $1&quot;</span>
<span class="n">pwd</span>
<span class="n">ls</span>
<span class="n">pytest</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing s24-06643-L08/entrypoint.sh
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>s24-06643-L08/entrypoint.sh
</pre></div>
</div>
</div>
</div>
<p>Next we make the Dockerfile. We have to provide directions in this file to setup our environment. Docker is complicated, and we wonâ€™t get all the way into it. The gist here is we start with a base image <code class="docutils literal notranslate"><span class="pre">python3-slim</span></code>, and then install software in it, and copy our script into it. GitHUB will build the image, and use it for your actions. The <a class="reference external" href="http://entrypoint.sh">entrypoint.sh</a> script is run when the image starts up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/Dockerfile
<span class="c1"># Container image that runs your code</span>
<span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mi">3</span><span class="o">-</span><span class="n">slim</span> 

<span class="n">RUN</span> <span class="n">pip3</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span> <span class="n">setuptools</span> <span class="n">wheel</span> <span class="n">matplotlib</span> <span class="n">requests</span> <span class="n">IPython</span> <span class="n">pytest</span>

<span class="c1"># Copies your code file from your action repository to the filesystem path `/` of the container</span>
<span class="n">COPY</span> <span class="n">entrypoint</span><span class="o">.</span><span class="n">sh</span> <span class="o">/</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">sh</span>
    
<span class="c1"># Code file to execute when the docker container starts up (`entrypoint.sh`)</span>
<span class="n">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span> <span class="s2">&quot;/entrypoint.sh&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing s24-06643-L08/Dockerfile
</pre></div>
</div>
</div>
</div>
<p>Next, we set up a GitHUB <em>action</em>. This is a yaml file saved as <code class="docutils literal notranslate"><span class="pre">action.yml</span></code> in your repo root. This is a little different than the workflows above. This defines some inputs that will be used and passed to the Docker image.</p>
<p>The syntax <code class="docutils literal notranslate"><span class="pre">${{</span> <span class="pre">inputs.who-to-greet</span> <span class="pre">}}</span></code> is <code class="docutils literal notranslate"><span class="pre">like</span></code> a python f-string, but in yaml instead. The value of â€œwho-to-greetâ€ will be used in the template string.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%%writefile  s24-06643-L08/action.yml
name: &#39;Hello World&#39;
description: &#39;Greet someone and record the time&#39;
inputs:
  who-to-greet:  # id of input
    description: &#39;Who to greet&#39;
    required: true
    default: &#39;World&#39;

runs:
  using: &#39;docker&#39;
  image: &#39;Dockerfile&#39;
  args:
    - ${{ inputs.who-to-greet }}
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing s24-06643-L08/action.yml
</pre></div>
</div>
</div>
</div>
<p>Finally, we define a workflow to use our action. We specify a â€œpathâ€ to our action, which is of the form <code class="docutils literal notranslate"><span class="pre">&lt;user&gt;/&lt;repo&gt;&#64;&lt;version&gt;</span></code>. For version we use the main branch, which should always use the latest version. Next we define the input we want using <code class="docutils literal notranslate"><span class="pre">with</span></code>. The name of this variable matches the name used in the inputs of the action. Put this into <code class="docutils literal notranslate"><span class="pre">.github/workflows/try-docker.yaml</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%writefile</span> s24-06643-L08/.github/workflows/try-docker.yaml
<span class="n">name</span><span class="p">:</span> <span class="n">Try</span> <span class="n">Docker</span>
<span class="n">on</span><span class="p">:</span> <span class="n">push</span>

<span class="n">jobs</span><span class="p">:</span>
  <span class="n">run</span><span class="o">-</span><span class="n">my</span><span class="o">-</span><span class="n">docker</span><span class="p">:</span>
    <span class="n">runs</span><span class="o">-</span><span class="n">on</span><span class="p">:</span> <span class="n">ubuntu</span><span class="o">-</span><span class="n">latest</span>
    <span class="n">steps</span><span class="p">:</span>      
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">actions</span><span class="o">/</span><span class="n">checkout</span><span class="nd">@v3</span>
      <span class="o">-</span> <span class="n">uses</span><span class="p">:</span> <span class="n">jkitchin</span><span class="o">/</span><span class="n">s24</span><span class="o">-</span><span class="mi">06643</span><span class="o">-</span><span class="n">L08</span><span class="nd">@main</span>
        <span class="k">with</span><span class="p">:</span>
          <span class="n">who</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">greet</span><span class="p">:</span> <span class="n">John</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing s24-06643-L08/.github/workflows/try-docker.yaml
</pre></div>
</div>
</div>
</div>
<p>Finally, push these out to GitHUB.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
cd s24-06643-L08
git add entrypoint.sh Dockerfile action.yml .github/workflows/try-docker.yaml
git commit -m &quot;added docker&quot;
git push
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[main 7213353] added docker
 4 files changed, 40 insertions(+)
 create mode 100644 .github/workflows/try-docker.yaml
 create mode 100644 Dockerfile
 create mode 100644 action.yml
 create mode 100755 entrypoint.sh
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>To github.com:jkitchin/s24-06643-L08.git
   08df131..7213353  main -&gt; main
</pre></div>
</div>
</div>
</div>
<p>When you push this, you will see in the actions output, â€œHello Johnâ€, and some other output for the tests.</p>
<p>This may seem like quite some overkill to print â€œHello Johnâ€. The real value of this comes when you start using files in the repo as input to do more sophisticated analysis.</p>
<p>Finally, this Docker image is built at run time. This is not the fastest way to do this. A faster way is to register the images on DockerHUB, and then you just use the image directly.</p>
<p>There is <em>so much</em> flexibility in Docker images. Their main limitation is they are Linux based.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="cleaning-up">
<h1>Cleaning up<a class="headerlink" href="#cleaning-up" title="Permalink to this headline">Â¶</a></h1>
<p>You can delete your GitHUB repo now if you want. Go to the settings tab (something like <a class="reference external" href="https://github.com/jkitchin/s24-06643-L08/settings">https://github.com/jkitchin/s24-06643-L08/settings</a>). Scroll to the bottom, and click <code class="docutils literal notranslate"><span class="pre">Delete</span> <span class="pre">this</span> <span class="pre">repository</span></code>. Donâ€™t worry, you can re-fork it.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./08-github-actions"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../07-github-intro/07-github-intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction to GitHUB</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../09-wrapup/09-wrapup.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Wrapping up</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By John Kitchin<br/>
    
        &copy; Copyright 2024.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>